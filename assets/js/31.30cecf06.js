(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{616:function(t,s,a){"use strict";a.r(s);var n=a(3),r=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("本文主要从一个功能点切入描述一种页面刷新路由不改变但只重新加载组件，不要使这个页面重新渲染的解决办法。用到 router 的方法有 replace 以及进阶模块导航守卫 beforeRouterEnter。")]),t._v(" "),a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),a("p",[t._v("首先描述一下功能背景，新增数据是步骤形式的，这种交互还是比较常见的，针对录入信息较多的时候需要分类按步骤录入。举个例子比如人员信息新增时，会涉及一下信息。")]),t._v(" "),a("ul",[a("li",[t._v("基本信息（身份证读卡器读取）")]),t._v(" "),a("li",[t._v("业务信息（根据身份证号查出所在班组、参见单位以及一些需要手动录入的信息）")]),t._v(" "),a("li",[t._v("人脸采集（本地摄像头拍照采集）\n步骤模块的开发设计通常是不改变路由的，第一步到最后一步路由始终是,例如：/add")])]),t._v(" "),a("h2",{attrs:{id:"问题需求点描述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题需求点描述"}},[t._v("#")]),t._v(" 问题需求点描述")]),t._v(" "),a("p",[a("strong",[t._v("重点功能来了")])]),t._v(" "),a("p",[t._v("当一组数据新增完毕后选择继续新增时，期望当前页面跳转到第一步,使用 this.$router.go(0)或者 location.reload 可以解决，但是会使整个页面重载，会有白屏和等待时间体验不好。")]),t._v(" "),a("p",[t._v("补充：你可能想到 v-if 或者 v-show 切换展示组件是不是也可以解决，但是你需要处理多个页面清空操作，步骤式的操作不仅仅是下一步还有上一步操作，前一步输入的信息与后一步有关联，设计考虑上会比较复杂且容易出 bug。因此我们还是从路由入手寻找解决办法。")]),t._v(" "),a("p",[t._v("需求总结：仅重新加载组件，不要使整个页面重载。")]),t._v(" "),a("h2",{attrs:{id:"解决办法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决办法"}},[t._v("#")]),t._v(" 解决办法")]),t._v(" "),a("p",[t._v("解决的办法：使用 replace 方法走一个中间组件。相当于 a 到 b，b 到 a。b 在 beforeRouterEnter 时进行处理")]),t._v(" "),a("p",[t._v("b.vue")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 用于刷新的中间组件  Component -> Refresh -> Component 场景举例: 步骤式新增成功后的<继续新增>按钮")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Refresh'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("beforeRouteEnter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("next")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("vm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      vm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$router"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br")])]),a("h2",{attrs:{id:"一些疑问点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一些疑问点"}},[t._v("#")]),t._v(" 一些疑问点")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("为什么使用 replace 而不使用 push?\n其实用 push 也行,就是 push 会在 history 也就是浏览器的历史里留下记录，但是用 replace 就不会，由于这里是一个不需要展示的中间件就不必留下记录了")])]),t._v(" "),a("li",[a("p",[t._v("不使用中间件使用 push 或者 replace 能不能跳转到自身呢\n经过测试，push 自身或者 replace 自身，页面展示依然停留在完成页，没有回到第一步。")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);